---
title: "Homework 05 - Putting it all together!"
author: "RUBRIC"
date: "RUBRIC"
output: html_document
---

### Load packages and data

```{r load-packages, message=FALSE}
library(tidyverse)
library(lubridate)
```

## Exercises

### Exercise 1

### **Half point for each of reading, glimpse, and correct narrative response - (MAX 1.5)**

```{r read-in-data}
tornado_data <- read_csv("data/tornado-path.csv")
glimpse(tornado_data)
```

The data set `tornado-paths.csv` contains 16,000 rows and 19 columns.

### Exercise 2

### **Half point each for reading data correctly and selecting variables - (MAX 1)**

```{r tornado-subset}
tornado_data <- read_csv("data/tornado-path.csv") %>% 
  select(storm_date, storm_time, state_name, magnitude, fatality_count, length, width)
```

### Exercise 3

### **Half point each for glimpse, identifying character string variable, and writing object out to data/ - (MAX 1.5)**

```{r look-at-tornado-subset}
glimpse(tornado_data)
```

`magnitude` is character string data type, rather than numeric, as we might expect.

```{r write-new-object}
write_csv(tornado_data, "data/tornado_data.csv")
```

### Exercise 4

### **Half point each for reading new file, using col_types argument, specifying list, and col_types within list - (MAX 2)**

```{r fix-magnitude}
tornado_data_fixed <- read_csv("data/tornado_data.csv", col_types = list(col_date(),
                                                                  col_time(),
                                                                  col_character(),
                                                                  col_integer(),
                                                                  col_integer(),
                                                                  col_double(),
                                                                  col_double())) 
glimpse(tornado_data_fixed)
```

### **Half point for each correct line of code requested and half point for reasonable interpretation - (MAX 4)**

### Exercise 5

```{r time-fatality-relationship}
tornado_data_fixed %>% 
  filter(state_name %in% c("Kansas", "Oklahoma")) %>% 
  ggplot(aes(storm_time, y = fatality_count, color = state_name, size = width)) +
  geom_point() +
  facet_wrap(~ magnitude) +
  labs(x = "Time of Day", y = "Fatality Count") +
  theme_bw()
```

The largest fatalities from tornadoes occur for F3-5 (strong) tornadoes and there also seems to be higher fatalities during the day time.
However it also appears that the occurence of very strong tornados is more likely in the afternoon and evening.
