---
title: "Lab 08 - Quantifying Uncertainty"
author: "RUBRIC"
date: "RUBRIC"
output: html_document
---

### Load packages and data

```{r load-packages, message = FALSE}
library(tidyverse)
library(tidymodels)
library(lubridate)
```

## Exercises

### Exercise 1

#### Half a point for function, half for correct file path/object name (MAX 1 point)

```{r import-data}
fluxes <- read_csv("lab-08-quantifying-uncertainty-starter/data/us-mms-simple.csv")
```

## Fix dates

```{r fix-dates, eval = T}
fluxes <- fluxes %>% 
  mutate(date = mdy_hm(date))
head(fluxes)
```

### Exercise 2

#### Half point for date, half point for selecting a variable (MAX 1 point)

```{r subset-fluxes, eval = T}
fluxes_subset <- fluxes %>% 
  filter(date > "2020-07-01" & date < "2020-07-31") %>% 
  select(date, fco2, incoming_radiation)
head(fluxes_subset, 10) 
```

### Exercise 3

#### Half a point for number of rows, half for correct interpretation (MAX 1 point)

There are `r nrow(fluxes_subset)` in the new month-long `fluxes_subset` dataset for July 2020.

Each row is an hourly observation of average net ecosystem exchange (`fco2`) and incoming solar radiation.

### Exercise 4

#### Full point for yes or no, as long as explanation reasonable (MAX 1 point)

No, one month of data is not a good sample of the entire summer because it is not a random sample through time and/or it is a biased sample in time and/or it is not representative of the entire summer.

Yes, one month of data is a good sample of the summer because it is a relatively large sample size (1/3 of all observations) and/or all the data are drawn from the summer season which **may not** vary much month-to-month.

### Exercise 5

#### half point for correct code from lab 7, half point for correct insertion of variables; half point for each estimate interpretation (MAX 2 points)

```{r fit-fco2-model, eval = T}
linear_reg() %>% 
  set_engine("lm") %>% 
  fit(fco2 ~ incoming_radiation, data = fluxes_subset) %>% 
  tidy()
```

The first estimate value is the y-intercept, in other words, the value of `fco2` when there is no incoming solar radiation (`incoming_radiation` = 0).
The second estimate value is the b coefficient for the relationship with `incoming_radiation`.
We interpret it as follows: `fco2` increases by `-0.028` (nmol m-2 s-1) (units not necessary) for every unit increase in incoming solar radiation (`incoming_radiation`).

### Exercise 5 part II

#### 1 point for completing correctly (MAX 1 point)

#### NOTE to students: `n =` to be added to be specificied within slice_head() (sorry for this typo)

```{r randomoize-and-slice, eval = T}
monroe_july_subsample <- fluxes_subset %>% 
  mutate(row = 1:n(),
         rrow = sample(row, size = n(), replace  = F)) %>% 
  arrange(rrow) %>% 
  slice_head(n = 144)
```

### Exercise 6

#### half point for completing correctly (MAX 0.5 point)

```{r create-bootstraps, eval = T}
monroe_july_boot <- bootstraps(monroe_july_subsample, times = 1000)
```

### Exercise 7

#### half point for correct inputs and output dataset names; half point for correct model specification (MAX 1 point)

```{r fit-models, eval = T}
monroe_july_models <- monroe_july_boot %>%
  mutate(
    model = map(splits, ~ lm(fco2 ~ incoming_radiation, data = .)),
    coef_info = map(model, tidy)
  )
```

### Exercise 8

#### half point for input `monroe_MONTH_model`; half point for using created object as second argument in `int_pctl()`; everyone automatically gets the last point for correct output because my prompt created a problem as I asked students to use a different object name (not `coef_info`) (MAX 1.5 points)

coef_info \<- monroe_july_models %\>% unnest(coef_info)

int_pctl(monroe_july_models, coef_info) \`\`\`
